# Sisi Print - برنامج طباعة الأرقام على طابعة الباركود

## نظرة عامة
برنامج Windows Forms بلغة C# مخصص لطباعة أرقام تلقائية على طابعة باركود Xprinter XP-370B.

## ⚠️ تحذير هام
**هذا التطبيق هو Windows Forms Desktop Application ويتطلب نظام Windows للتشغيل.**

Replit يعمل على نظام Linux ولا يمكن تشغيل تطبيقات Windows Forms عليه. يمكنك:
1. **تطوير الكود هنا** - يمكنك كتابة وتعديل الكود في Replit
2. **البناء على Windows** - قم بتنزيل المشروع وبناءه على جهاز Windows
3. **التشغيل على Windows** - قم بتشغيل الملف التنفيذي (.exe) على جهاز Windows متصل بالطابعة

## المواصفات

### الوظائف الرئيسية
1. ✅ قراءة جميع الطابعات المثبتة على Windows
2. ✅ واجهة عربية (RightToLeft = True)
3. ✅ إدخال نطاق الأرقام (من - إلى)
4. ✅ تخصيص حجم الورقة (عرض × ارتفاع بالمم)
5. ✅ تعيين قيمة Gap
6. ✅ اختيار حجم الخط (صغير - متوسط - كبير)
7. ✅ طباعة باركود Code128 اختياري
8. ✅ حفظ/تحميل الإعدادات تلقائياً (settings.json)
9. ✅ طباعة اختبار (رقمين: 999 و 1000)
10. ✅ **طباعة رقمين فوق بعض في كل ورقة**

### التقنيات المستخدمة
- **.NET 8.0** - Windows Forms
- **TSPL Commands** - أوامر طابعة Xprinter XP-370B
- **Raw Printing** - إرسال أوامر مباشرة للطابعة
- **JSON** - حفظ الإعدادات

## بنية المشروع

```
sisi_print/
├── Form1.cs              # المنطق الرئيسي للنموذج
├── Form1.Designer.cs     # تصميم الواجهة
├── RawPrinterHelper.cs   # مساعد الطباعة المباشرة
├── Program.cs            # نقطة الدخول
└── sisi_print.csproj     # ملف المشروع
```

## كيفية البناء والتشغيل

### على جهاز Windows:

```bash
# 1. Clone المشروع أو قم بتنزيله
git clone [repository-url]

# 2. افتح المشروع
cd sisi_print

# 3. Build المشروع
dotnet build sisi_print.sln

# 4. Run التطبيق
dotnet run --project sisi_print/sisi_print.csproj
```

### أو استخدم Visual Studio:
1. افتح `sisi_print.sln` في Visual Studio
2. اضغط F5 للتشغيل

## أوامر TSPL المستخدمة

البرنامج يستخدم أوامر TSPL لطابعة Xprinter XP-370B:

```tspl
SIZE [width] mm, [height] mm     # حجم الورقة
GAP [gap] mm, 0 mm                # المسافة بين الأوراق
DIRECTION 0, 0                    # اتجاه الطباعة
DENSITY 10                        # كثافة الحبر
TEXT [x], [y], "4", 0, [mul], [mul], "[number]"  # طباعة النص
BARCODE [x], [y], "128", [h], 1, 0, 2, 2, "[number]"  # الباركود
PRINT 1                           # طباعة ورقة واحدة
```

## الملفات المولدة

- **settings.json** - يُحفظ تلقائياً بجانب الملف التنفيذي ويحتوي على:
  - آخر طابعة مختارة
  - نطاق الأرقام
  - أبعاد الورقة
  - قيمة Gap
  - حجم الخط
  - حالة خيار الباركود

## متطلبات التشغيل

1. **نظام التشغيل**: Windows 10/11
2. **.NET Runtime**: .NET 8.0 أو أحدث
3. **الطابعة**: Xprinter XP-370B (أو طابعة متوافقة مع TSPL)
4. **Driver**: تعريف الطابعة مثبت على Windows

## الدعم الفني

للمشاكل المتعلقة بـ:
- **الطباعة**: تأكد من تثبيت تعريف الطابعة بشكل صحيح
- **الباركود**: تأكد من أن الطابعة تدعم Code128
- **حجم الورق**: تأكد من إعدادات الطابعة تطابق أبعاد الورق المدخلة

## ملاحظة مهمة عن الطباعة

⭐ **البرنامج يطبع رقمين في كل ورقة (فوق بعض)**
- الرقم الأول في النصف العلوي من الورقة
- الرقم الثاني في النصف السفلي من الورقة
- كل رقم مع الباركود الخاص به (إذا كان الخيار مفعلاً)

مثال: إذا طبعت من 1 إلى 10:
- الورقة الأولى: 1 (أعلى) و 2 (أسفل)
- الورقة الثانية: 3 (أعلى) و 4 (أسفل)
- وهكذا...

## التحديثات الأخيرة

- 2025-11-07: تعديل البرنامج لطباعة رقمين في كل ورقة بدلاً من رقم واحد
- 2025-11-07: إصلاح مواضع الطباعة والباركود
- 2025-11-07: إنشاء المشروع الأولي بجميع المواصفات المطلوبة
